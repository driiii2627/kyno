module.exports=[6901,80494,a=>{"use strict";var b=a.i(45618);let c=process.env.NEXT_PUBLIC_SUPABASE_URL,d=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,e=(0,b.createClient)(c,d),f=()=>{let a=process.env.SUPABASE_SERVICE_ROLE_KEY;if(!a)throw Error("Missing SUPABASE_SERVICE_ROLE_KEY environment variable");return(0,b.createClient)(c,a)};a.s(["getServiceSupabase",0,f,"supabase",0,e],80494),a.s(["contentService",0,{async getAppConfig(a,b){try{let{data:c,error:d}=await e.from("app_config").select("value").eq("key",a).single();if(d||!c)return b;return c.value}catch(c){return console.error(`Failed to fetch config for ${a}`,c),b}},async getMovieById(a){let{data:b,error:c}=await e.from("movies").select("tmdb_id, video_url").eq("id",a).single();return c||!b?null:{tmdb_id:b.tmdb_id,video_url:b.video_url}},async getSeriesById(a){let{data:b,error:c}=await e.from("series").select("tmdb_id, video_url").eq("id",a).single();return c||!b?null:{tmdb_id:b.tmdb_id,video_url:b.video_url}},async getItemByUuid(a){let[b,c]=await Promise.all([this.getMovieById(a),this.getSeriesById(a)]);return b?{type:"movie",...b}:c?{type:"tv",...c}:null},async getItemByTmdbId(a,b){let{data:c,error:d}=await e.from("movie"===b?"movies":"series").select("id").eq("tmdb_id",a).single();return{data:c,error:d}},async syncMovies(a){if(a.length)try{let b=f(),c=await this.getAppConfig("superflix_base_url","https://superflixapi.buzz"),d=a.map(a=>{let b=2025,d=a.release_date||a.first_air_date;if(d){let a=new Date(d);isNaN(a.getTime())||(b=a.getFullYear())}let e=a.genres?a.genres.map(a=>a.name).join(", "):"",f=a.runtime||0,g=`${c}/filme/${a.id}`;return{tmdb_id:a.id,video_url:g,title:a.title||a.name||"Sem Título",description:a.overview||"",poster_url:a.poster_path||"",backdrop_url:a.backdrop_path||"",release_year:b,rating:"number"==typeof a.vote_average?a.vote_average:0,genre:e,duration:f,type:"movie"}}),{error:e}=await b.from("movies").upsert(d,{onConflict:"tmdb_id",ignoreDuplicates:!1});e&&console.error("Sync Movies Error:",e)}catch(a){console.error("Sync Movies Exception:",a)}},async syncSeries(a){if(a.length)try{let b=f(),c=await this.getAppConfig("superflix_base_url","https://superflixapi.buzz"),d=a.map(a=>{let b=2025,d=a.first_air_date||a.release_date;if(d){let a=new Date(d);isNaN(a.getTime())||(b=a.getFullYear())}let e=a.genres?a.genres.map(a=>a.name).join(", "):"",f=`${c}/serie/${a.id}`;return{tmdb_id:a.id,video_url:f,title:a.name||a.title||"Sem Título",description:a.overview||"",poster_url:a.poster_path||"",backdrop_url:a.backdrop_path||"",release_year:b,rating:"number"==typeof a.vote_average?a.vote_average:0,genre:e}}),{error:e}=await b.from("series").upsert(d,{onConflict:"tmdb_id",ignoreDuplicates:!1});e&&console.error("Sync Series Error:",e)}catch(a){console.error("Sync Series Exception:",a)}},async getCatalogMovies(){let{data:a,error:b}=await e.from("movies").select("*").order("created_at",{ascending:!1});return b?(console.error("Error fetching movies from Supabase:",b),[]):a?a.map(a=>({id:a.tmdb_id,title:a.title||"Sem Título",poster_path:a.poster_url,backdrop_path:a.backdrop_url,overview:a.description,vote_average:a.rating||0,release_date:a.release_year?.toString(),video_url:a.video_url,supabase_id:a.id,genre:a.genre,genres:a.genre?[{id:0,name:a.genre}]:[],duration:a.duration})):[]},async getCatalogSeries(){let{data:a,error:b}=await e.from("series").select("*").order("created_at",{ascending:!1});return b?(console.error("Error fetching series from Supabase:",b),[]):a?a.map(a=>({id:a.tmdb_id,name:a.title||"Sem Título",title:a.title||"Sem Título",poster_path:a.poster_url,backdrop_path:a.backdrop_url,overview:a.description,vote_average:a.rating||0,first_air_date:a.release_year?.toString(),video_url:a.video_url,supabase_id:a.id,genre:a.genre,genres:a.genre?[{id:0,name:a.genre}]:[]})):[]}}],6901)},88730,a=>{"use strict";let b=process.env.NEXT_PUBLIC_TMDB_BASE_URL||"https://api.themoviedb.org/3",c=process.env.TMDB_API_KEY||"e407e3f55ac924320df3192273006442",d=async(a,d={})=>{let e=new URL(`${b}${a}`);e.searchParams.append("api_key",c),e.searchParams.append("language","pt-BR"),Object.keys(d).forEach(a=>e.searchParams.append(a,d[a])),console.log(`[TMDB Request] ${e.toString()}`);try{let a=await fetch(e.toString(),{next:{revalidate:3600}});if(!a.ok){let b=await a.text();throw console.error(`[TMDB Error] ${a.status} ${a.statusText}: ${b}`),Error(`TMDB Error: ${a.status}`)}return a.json()}catch(a){throw console.error("[TMDB Fetch Error]",a),a}};a.s(["tmdb",0,{getTrending:async(a="movie")=>d(`/trending/${a}/week`),getPopular:async(a="movie")=>d(`/${a}/popular`),getTopRated:async(a="movie")=>d(`/${a}/top_rated`),getByGenre:async(a,b="movie")=>d(`/discover/${b}`,{with_genres:a.toString()}),getDetails:async(a,b)=>d(`/${b}/${a}`),getCredits:async(a,b)=>d(`/${b}/${a}/credits`),getSeasonDetails:async(a,b)=>d(`/tv/${a}/season/${b}`),getRecommendations:async(a,b)=>(await d(`/${b}/${a}/recommendations`)).results||[],getCollectionDetails:async a=>d(`/collection/${a}`)}])},2423,a=>{"use strict";var b=a.i(79714),c=a.i(37936),d=a.i(88730),e=a.i(6901),f=a.i(13095);async function g(a,b){let c=await d.tmdb.getSeasonDetails(a,b),e=await Promise.all(c.episodes.map(async c=>{try{let d=`https://superflixapi.buzz/serie/${a}/${b}/${c.episode_number}`,e=await fetch(d,{cache:"no-store"});if(!e.ok)return null;let f=(await e.text()).match(/href="([^"]+)"\s+class="btn btn-secondary">Visualização<\/a>/);if(!f||!f[1])return null;let g=f[1],h=await fetch(g,{method:"HEAD",cache:"no-store"});return 200===h.status?c:null}catch(a){return console.error(`Error checking ep ${c.episode_number}:`,a),null}}));return{...c,episodes:e.filter(a=>null!==a)}}let h={movie:null,tv:null};async function i(a,b){try{let c="movie"===b?"movie":"serie",d=h[b];if(d&&Date.now()-d.timestamp<36e5)return d.ids.has(a.toString());let e=`https://superflixapi.buzz/lista?category=${c}&type=tmdb&format=json`;console.log(`Fetching Superflix list for ${c}...`);let f=await fetch(e,{method:"GET",cache:"no-store"});if(!f.ok)return console.error("Superflix list fetch failed:",f.status),!1;let g=await f.json(),i=new Set(g);return h[b]={timestamp:Date.now(),ids:i},i.has(a.toString())}catch(c){return console.error(`Superflix verification failed for ${b} ${a}:`,c),!1}}async function j(a,b){let{data:c,error:f}=await e.contentService.getItemByTmdbId(a,b);if(c)return c.id;try{let c=await d.tmdb.getDetails(a,b),f=c.release_date||c.first_air_date;if(!f)return console.warn(`Content ${a} rejected: No release date.`),null;let g=new Date(f),h=new Date;if(g>h||"status"in c&&"Released"!==c.status&&"Returning Series"!==c.status&&"Ended"!==c.status||!await i(a,b))return null;"movie"===b?await e.contentService.syncMovies([c]):await e.contentService.syncSeries([c]);let{data:j}=await e.contentService.getItemByTmdbId(a,b);return j?.id}catch(a){return console.error("Failed to resolve content",a),null}}(0,f.ensureServerEntryExports)([g,j]),(0,c.registerServerReference)(g,"604e6f8cc0e894a8d01029d82fda6f5e2efe792dcc",null),(0,c.registerServerReference)(j,"608900d8847eb3c996304a813940a36087fb7e5904",null),a.s([],47190),a.i(47190),a.s(["00044a13b912e98127fb87132cc89613aabacf9b57",()=>b.signOutAction,"0018c6db43529b3ca9c55f1a4bb647fb8415811d1d",()=>b.getProfilesAction,"0056cb79b9ec21b37d317dc696b43a5f5c326ae982",()=>b.getActiveProfileAction,"4009cb87dbf8261408287db81f95ca338a80372201",()=>b.switchProfileAction,"407fa483aadb683ffaf8d267be44a2d4010bfbd905",()=>b.createProfileAction,"40c7e6cc5ffa74f4aaa5de5b158ce112ad5e6af404",()=>b.updateProfileAction,"40fc0c27050575de9cc323afb67bce1d8322753d08",()=>b.deleteProfileAction,"604e6f8cc0e894a8d01029d82fda6f5e2efe792dcc",()=>g],2423)}];

//# sourceMappingURL=_87a0585a._.js.map